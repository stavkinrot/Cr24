<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CRX Generator â€“ Chat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="./styles.css" rel="stylesheet" />
  </head>
  <body class="chat-body">
    <!-- Sidebar for chat list -->
    <aside id="chat-sidebar" class="chat-sidebar" hidden>
      <div class="sidebar-header">
        <h2>Chats</h2>
        <button id="closeSidebar" class="icon-button" type="button" aria-label="Close sidebar">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
            <path d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 0 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/>
          </svg>
        </button>
      </div>
      <div class="chat-list" id="chat-list">
        <!-- Chat items will be populated here -->
      </div>
    </aside>

    <main class="chat-container">
      <header class="appbar">
        <h1>CRX Generator</h1>
        <div class="appbar-actions">
          <button id="newChatButton" class="icon-button" type="button" aria-label="New chat" title="New chat">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
          </button>
          <button id="chatListButton" class="icon-button" type="button" aria-label="Show chats" title="Show chats">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
              <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
            </svg>
          </button>
          <button id="themeToggle" type="button" aria-label="Toggle theme">Dark mode</button>
        </div>
      </header>

      <!-- Chat messages -->
      <section id="messages" class="messages" aria-live="polite" aria-relevant="additions"></section>

      <!-- Sticky input bar -->
      <form id="chat-form" class="composer" autocomplete="off">
        <button id="modelButton" class="icon-button" type="button" title="Model & settings" aria-haspopup="true" aria-expanded="false">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
            <path d="M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.61-.22l-2.39.96a7.08 7.08 0 0 0-1.63-.94l-.36-2.54A.5.5 0 0 0 14.3 2h-4.6a.5.5 0 0 0-.5.42l-.36 2.54c-.6.24-1.16.56-1.68.94l-2.39-.96a.5.5 0 0 0-.61.22L2.64 8.48a.5.5 0 0 0 .12.64l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32c.14.24.43.34.69.22l2.39-.96c.51.39 1.08.71 1.68.94l.36 2.54c.04.27.27.46.54.46h4.6c.27 0 .5-.19.54-.46l.36-2.54c.6-.24 1.16-.56 1.68-.94l2.39.96c.26.12.55.02.69-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58zM12 15.5A3.5 3.5 0 1 1 12 8.5a3.5 3.5 0 0 1 0 7z"/>
          </svg>
        </button>

        <textarea id="chat-input" class="composer-input" rows="1" placeholder="What would you like your extension to do?" required></textarea>

        <button id="send" class="primary" type="submit" title="Send">Send</button>

        <!-- Model popover -->
        <div id="model-popover" class="popover" hidden>
          <label class="stack">
            <span>Model</span>
            <select id="ai-model">
              <option value="auto" selected>Auto / Best</option>
              <option value="gpt-5">gpt-5</option>
              <option value="gpt-4.1">gpt-4.1</option>
              <option value="gpt-4o">gpt-4o</option>
              <option value="gpt-4o-mini">gpt-4o-mini</option>
            </select>
          </label>

          <label class="stack">
            <span>Temperature <span id="ai-temp-val">0.4</span></span>
            <input id="ai-temp" type="range" min="0" max="1" step="0.05" value="0.4" />
          </label>
        </div>
      </form>
    </main>

    <script type="module" src="./popup.ts"></script>
  </body>
</html>
